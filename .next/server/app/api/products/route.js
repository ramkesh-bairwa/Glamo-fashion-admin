(()=>{var e={};e.id=146,e.ids=[146],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},7462:(e,t,r)=>{"use strict";r.d(t,{P:()=>o});let s=r(46101).createPool({host:process.env.MYSQL_HOST||"localhost",user:process.env.MYSQL_USER||"root",password:process.env.MYSQL_PASSWORD||"",database:process.env.MYSQL_DATABASE||"admin_panel",waitForConnections:!0,connectionLimit:10,queueLimit:0});async function o(e,t=[]){let[r]=await s.execute(e,t);return r}console.log(s)},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},17615:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{GET:()=>c,POST:()=>l});var o=r(32190),n=r(41098),a=r(7462),i=r(45500),u=e([i]);async function c(e){try{if(!await (0,n.qc)(e))return o.NextResponse.json({message:"Unauthorized"},{status:401});let{searchParams:t}=new URL(e.url),r=parseInt(t.get("page")||"1",10),s=parseInt(t.get("limit")||"10",10),i=t.get("search")||"",u=(r-1)*s,c=`
      SELECT p.*, c.name as category
      FROM products p
      LEFT JOIN categories c ON p.category_id = c.id
    `,l=[];i&&(c+=" WHERE p.name LIKE ? OR p.description LIKE ?",l.push(`%${i}%`,`%${i}%`));let p=`
      SELECT COUNT(*) as total FROM products
      ${i?"WHERE name LIKE ? OR description LIKE ?":""}
    `,d=i?[`%${i}%`,`%${i}%`]:[],g=(await (0,a.P)(p,d))[0].total;c+=" ORDER BY p.created_at DESC LIMIT ? OFFSET ?",l.push(s,u);let m=await (0,a.P)(c,l);return o.NextResponse.json({products:m,page:r,limit:s,totalItems:g,totalPages:Math.ceil(g/s)})}catch(e){return console.error("Error fetching products:",e),o.NextResponse.json({message:"Internal server error"},{status:500})}}async function l(e){try{if(!await (0,n.qc)(e))return o.NextResponse.json({message:"Unauthorized"},{status:401});let t=await e.formData(),r=t.get("brand_id"),s=t.get("product_url");if(!s||"string"!=typeof s)return console.error("Invalid or missing product_url",t),o.NextResponse.json({message:"Invalid or missing product_url"},{status:200});let a=r?parseInt(r.toString(),10):null;if(!a||isNaN(a))throw console.error("Invalid or missing brand_id",t),Error("Invalid or missing brand ID");return o.NextResponse.json({message:"Internal server error"},{url:s})}catch(e){return console.error("Error creating product:",e),o.NextResponse.json({message:"Internal server error"},{status:500})}}i=(u.then?(await u)():u)[0],s()}catch(e){s(e)}})},19771:e=>{"use strict";e.exports=require("process")},27910:e=>{"use strict";e.exports=require("stream")},28303:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=28303,e.exports=t},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},34631:e=>{"use strict";e.exports=require("tls")},41098:(e,t,r)=>{"use strict";r.d(t,{HU:()=>u,OB:()=>d,VX:()=>p,l4:()=>c,qc:()=>l});var s=r(43205),o=r(44999),n=r(7462);let a=process.env.JWT_SECRET||"your-secret-key",i="admin_token";function u(e,t,r){return(0,s.sign)({userId:e,email:t,role:r},a,{expiresIn:"1d"})}async function c(e){try{let t=function(e){try{return(0,s.verify)(e,a)}catch(e){return null}}(e);if(!t)return null;let r=await (0,n.P)("SELECT id, name, email, role FROM users WHERE id = ?",[t.userId]);return r.length>0?r[0]:null}catch(e){return console.error("Error getting user from token:",e),null}}async function l(e){let t=(0,o.UL)(),r=t.get(i)?.value;if(!r)return!1;let s=await c(r);return s?.role==="admin"}function p(e,t){return e.cookies.set({name:i,value:t,httpOnly:!0,secure:!0,sameSite:"strict",maxAge:86400,path:"/"}),e}function d(e){return e.cookies.set({name:i,value:"",httpOnly:!0,secure:!0,sameSite:"strict",maxAge:0,path:"/"}),e}},41204:e=>{"use strict";e.exports=require("string_decoder")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},45500:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{A:()=>a});var o=r(83636),n=e([o]);o=(n.then?(await n)():n)[0];let a=async e=>{console.log(e);let t=await o.default.launch({headless:!0,args:["--no-sandbox","--disable-setuid-sandbox"]}),r=await t.newPage();try{await r.goto(e,{waitUntil:"domcontentloaded"}),console.log("Page loaded, waiting for product cards..."),await r.waitForSelector(".product-card",{timeout:3e4});let t=await r.evaluate(()=>{let e=Array.from(document.querySelectorAll(".product-card"));return console.log(`Found ${e.length} product cards`),e.map(e=>{let t=e.querySelector("h4")?.textContent?.trim()||"",r=e.querySelector(".price")?.textContent?.trim()||"";return{title:t,price:r}})});return 0===t.length&&console.warn("No products found!"),t}catch(e){return console.error("Error scraping:",e),[]}finally{await t.close()}};s()}catch(e){s(e)}})},55511:e=>{"use strict";e.exports=require("crypto")},61187:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{patchFetch:()=>c,routeModule:()=>l,serverHooks:()=>g,workAsyncStorage:()=>p,workUnitAsyncStorage:()=>d});var o=r(96559),n=r(48088),a=r(37719),i=r(17615),u=e([i]);i=(u.then?(await u)():u)[0];let l=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/products/route",pathname:"/api/products",filename:"route",bundlePath:"app/api/products/route"},resolvedPagePath:"/var/www/html/Glamo-fashion-admin/app/api/products/route.ts",nextConfigOutput:"standalone",userland:i}),{workAsyncStorage:p,workUnitAsyncStorage:d,serverHooks:g}=l;function c(){return(0,a.patchFetch)({workAsyncStorage:p,workUnitAsyncStorage:d})}s()}catch(e){s(e)}})},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},66136:e=>{"use strict";e.exports=require("timers")},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},83636:e=>{"use strict";e.exports=import("puppeteer")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},96487:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[524,839],()=>r(61187));module.exports=s})();